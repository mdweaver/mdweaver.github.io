felm(hc_per_capita ~ f_window | fips  | 0 | fips , any_rally[t_window %in% 0:1]) %>% summary
rally_data[, list(fips, monthyear)] %>% .[1:12]
rally_data[, l_rally := shift(trumprallycount, 1) , by = fips]
rally_data[, list(fips, monthyear, trumprallycount, l_rally)]
rally_data[, hc_per_capita := incidentcount/exp(log_pop)*100000]
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips + monthyear, rally_data) %>% summary
rally_data[, l_c_rally := shift(clintonrallycount, 1) , by = fips]
felm(hc_per_capita ~ I(l_c_rally > 0) | fips + monthyear | 0 | fips + monthyear, rally_data) %>% summary
felm(hc_per_capita ~ I(l_c_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
clinton_rally = rally_data[clintoneverrally %in% 1]
clinton_rally[, month_num := str_extract(monthyear, "\\d+$") %>% as.numeric]
clinton_rally[, t_window := month_num - min(month_num[clintonrallyoccured > 0]), by = fips]
clinton_rally[, hc_per_capita := incidentcount/exp(log_pop)*100000]
ggplot(clinton_rally[t_window %in% -3:3], aes(x = as.factor(t_window), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 4, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k")
clinton_rally[, t_window] %>% table
ggplot(clinton_rally[t_window %in% -2:2], aes(x = as.factor(t_window), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 4, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k")
ggplot(clinton_rally[t_window %in% -3:3], aes(x = as.factor(t_window), y = incidentcount)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 4, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k")
ggplot(trump_rally[t_window %in% -3:3], aes(x = as.factor(t_window), y = incidentcount)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 4, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k")
trump_rally = rally_data[trumpeverrally %in% 1]
trump_rally[, month_num := str_extract(monthyear, "\\d+$") %>% as.numeric]
trump_rally[, t_window := month_num - min(month_num[trumprallyoccured > 0]), by = fips]
trump_rally[, hc_per_capita := incidentcount/exp(log_pop)*100000]
ggplot(trump_rally[t_window %in% -3:3], aes(x = as.factor(t_window), y = incidentcount)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 4, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k")
trump_rally[, exp(log_pop)] %>% hist
ggplot(trump_rally[t_window %in% -3:3], aes(x = as.factor(t_window), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 4, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k")
ggplot(clinton_rally[t_window %in% -3:3], aes(x = as.factor(t_window), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 4, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k")
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(incidentcount ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(incidentcount ~ l_rally | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) + I(l_c_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
rally_data[, l2_rally := shift(trumprallycount, 2) , by = fips]
felm(hc_per_capita ~ I(l2_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(incidentcount ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(incidentcount ~ I(l2_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(incidentcount ~ I(trumprallycount > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(incidentcount ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips , rally_data) %>% summary
ggplot(trump_rally[t_window %in% -4:4], aes(x = as.factor(t_window), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 4, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k")
trump_rally$hc_per_capita %>% hist
rally_data[, sm_fe := paste(state_fips, monthyear, sep = ":")]
felm(hc_per_capita ~ I(l_rally > 0) | fips + sm_fe | 0 | fips , rally_data) %>% summary
felm(hc_per_capita ~ I(l_c_rally > 0) | fips + sm_fe | 0 | fips , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + sm_fe | 0 | fips+ monthyear , rally_data) %>% summary
felm(hc_per_capita ~ l_rally > 0| fips + sm_fe | 0 | fips, rally_data) %>% summary
felm(hc_per_capita ~ l_rally | fips + sm_fe | 0 | fips, rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + sm_fe | 0 | fips+ monthyear , rally_data) %>% summary
felm(incidentcount ~ I(l_rally > 0) | fips + sm_fe | 0 | fips+ monthyear , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + sm_fe | 0 | fips+ monthyear , rally_data) %>% summary
felm(hc_per_capita_alt ~ I(l_rally > 0) | fips + sm_fe | 0 | fips+ monthyear , rally_data) %>% summary
rally_data[, hc_per_capita_alt := hate_crimes / exp(log_pop) * 100000]
felm(hc_per_capita_alt ~ I(l_rally > 0) | fips + sm_fe | 0 | fips+ monthyear , rally_data) %>% summary
felm(hc_per_capita_alt ~ I(l_rally > 0) | fips + monthyear | 0 | fips+ monthyear , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips + monthyear , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips  , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips + monthyear , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + sm_fe | 0 | fips + monthyear , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + sm_fe | 0 | fips  , rally_data) %>% summary
ggplot(trump_rally[t_window %in% c(-1,1)], aes(x = as.factor(t_window), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k")
ggplot(trump_rally[t_window %in% c(-1,1)], aes(x = factor(t_window, labels = c("Before", "After")), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes")
ggplot(trump_rally[t_window %in% c(-1,1)], aes(x = factor(t_window, labels = c("Before", "After")), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Months Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes:\nBefore and After Trump Rallies")
trump_rally$fips %>% unique %>% length
clinton_rally$fips %>% unique %>% length
ggplot(clinton_rally[t_window %in% c(-1,1)], aes(x = factor(t_window, labels = c("Before", "After")), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 40 Counties:\nBefore and After Clinton Rallies")
ggplot(trump_rally[t_window %in% c(-1,1)], aes(x = factor(t_window, labels = c("Before", "After")), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 196 Counties:\nBefore and After Trump Rallies")+
ylim(0,0.1)
?ylim
?ylim
ggplot(trump_rally[t_window %in% c(-1,1)], aes(x = factor(t_window, labels = c("Before", "After")), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 196 Counties:\nBefore and After Trump Rallies")+
coord_cartesian(xlim = c(0,0.1))
ggplot(trump_rally[t_window %in% c(-1,1)], aes(x = factor(t_window, labels = c("Before", "After")), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 196 Counties:\nBefore and After Trump Rallies")+
coord_cartesian(ylim = c(0,0.1))
ggplot(clinton_rally[t_window %in% c(-1,1)], aes(x = factor(t_window, labels = c("Before", "After")), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 40 Counties:\nBefore and After Clinton Rallies")+
coord_cartesian(ylim = c(0,0.1))
ggplot(clinton_rally[t_window %in% c(0,1)], aes(x = factor(t_window, labels = c("Before", "After")), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 40 Counties:\nBefore and After Clinton Rallies")+
coord_cartesian(ylim = c(0,0.1))
ggplot(trump_rally[t_window %in% c(0,1)], aes(x = factor(t_window, labels = c("Before", "After")), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 196 Counties:\nBefore and After Trump Rallies")+
coord_cartesian(ylim = c(0,0.1))
require(ggdag)
require(dagitty)
dagify(hate_crime ~ rally + jewish + hate_group + crime + gop + univ + region,
rally ~ jewish + hate_group + crime + gop + univ + region,
exposure = "rally",
outcome = 'hate_crime',
labels = c('rally' = "(X) Trump\nRally",
'hate_crime' = "(Y) Hate Crimes",
'jewish' = '% Jewish',
'hate_group' = '# Hate\nGroups',
"crime" = "Crime Rate",
'gop' = 'Republican\nVoters',
'univ'= 'Univ.\nEducated',
'region' = "Region"
)) %>%
tidy_dagitty(layout='circle') %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
#geom_dag_node() +
geom_dag_edges_link(mapping = aes(label = c(rep('',8), "?" ,rep('', 5))),
angle_calc = "along", label_dodge = unit(rep(1,15),'lines')) +
geom_dag_text(mapping = aes(label = label), colour = 'black') +
theme_dag() +
scale_adjusted()
ggplot(clinton_rally[t_window %in% c(0,1)], aes(x = factor(t_window, labels = c("Before", "After")), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 1.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 40 Counties:\nBefore and After Clinton Rallies")+
coord_cartesian(ylim = c(0,0.1))
dagify(hate_crime ~ rally + unchanging + changing,
rally ~ unchanging + changing,
exposure = "rally",
outcome = 'hate_crime',
labels = c('rally' = "(X) Trump\nRally",
'hate_crime' = "(Y) Hate Crimes",
'changing' = 'Changing\nAttributes',
'unchanging' = 'Unchanging\nAttributes'
)) %>%
tidy_dagitty(layout='circle') %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
#geom_dag_node() +
geom_dag_edges_link() +
geom_dag_text(mapping = aes(label = label), colour = 'black') +
theme_dag() +
scale_adjusted()
dagify(hate_crime ~ rally + unchanging + changing,
rally ~ unchanging + changing,
exposure = "rally",
outcome = 'hate_crime',
labels = c('rally' = "(X) Trump\nRally",
'hate_crime' = "(Y) Hate Crimes",
'changing' = 'Changing\nAttributes',
'unchanging' = 'Unchanging\nAttributes'
)) %>%
tidy_dagitty(layout='circle') %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
#geom_dag_node() +
geom_dag_edges_link(mapping = aes(label = c(1:5))) +
geom_dag_text(mapping = aes(label = label), colour = 'black') +
theme_dag() +
scale_adjusted()
dagify(hate_crime ~ rally + unchanging + changing,
rally ~ unchanging + changing,
exposure = "rally",
outcome = 'hate_crime',
labels = c('rally' = "(X) Trump\nRally",
'hate_crime' = "(Y) Hate Crimes",
'changing' = 'Changing\nAttributes',
'unchanging' = 'Unchanging\nAttributes'
)) %>%
tidy_dagitty(layout='circle') %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
#geom_dag_node() +
geom_dag_edges_link(mapping = aes(label = c(1:6))) +
geom_dag_text(mapping = aes(label = label), colour = 'black') +
theme_dag() +
scale_adjusted()
dagify(hate_crime ~ rally + unchanging + changing,
rally ~ unchanging + changing,
exposure = "rally",
outcome = 'hate_crime',
labels = c('rally' = "(X) Trump\nRally",
'hate_crime' = "(Y) Hate Crimes",
'changing' = 'Changing\nAttributes',
'unchanging' = 'Unchanging\nAttributes'
)) %>%
tidy_dagitty(layout='circle') %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
#geom_dag_node() +
geom_dag_edges_link(mapping = aes(label = c(1:6)),
angle_calc = "along", label_dodge = unit(c(1,-1,1,-1,-1,1),'lines'),
edge_linetype = rep(c(1,1,1,2,2,2), each = 100),
arrow = grid::arrow(length=grid::unit(c(10,10,10,0,0,0), 'pt'), type = 'closed'))
+
geom_dag_text(mapping = aes(label = label), colour = 'black') +
theme_dag() +
scale_adjusted()
dagify(hate_crime ~ rally + unchanging + changing,
rally ~ unchanging + changing,
exposure = "rally",
outcome = 'hate_crime',
labels = c('rally' = "(X) Trump\nRally",
'hate_crime' = "(Y) Hate Crimes",
'changing' = 'Changing\nAttributes',
'unchanging' = 'Unchanging\nAttributes'
)) %>%
tidy_dagitty(layout='circle') %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
#geom_dag_node() +
geom_dag_edges_link(mapping = aes(label = c(1:6)),
angle_calc = "along", label_dodge = unit(c(1,-1,1,-1,-1,1),'lines'),
edge_linetype = rep(c(1,1,1,2,2), each = 100),
arrow = grid::arrow(length=grid::unit(c(10,10,10,0,0,0), 'pt'), type = 'closed'))
+
geom_dag_text(mapping = aes(label = label), colour = 'black') +
theme_dag() +
scale_adjusted()
dagify(hate_crime ~ rally + unchanging + changing,
rally ~ unchanging + changing,
exposure = "rally",
outcome = 'hate_crime',
labels = c('rally' = "(X) Trump\nRally",
'hate_crime' = "(Y) Hate Crimes",
'changing' = 'Changing\nAttributes',
'unchanging' = 'Unchanging\nAttributes'
)) %>%
tidy_dagitty(layout='circle') %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
#geom_dag_node() +
geom_dag_edges_link(mapping = aes(label = c(1:6)),
angle_calc = "along", label_dodge = unit(c(1,-1,1,-1,-1),'lines'),
edge_linetype = rep(c(1,1,1,2,2), each = 100),
arrow = grid::arrow(length=grid::unit(c(10,10,10,0,0,0), 'pt'), type = 'closed'))
+
geom_dag_text(mapping = aes(label = label), colour = 'black') +
theme_dag() +
scale_adjusted()
dagify(hate_crime ~ rally + unchanging + changing,
rally ~ unchanging + changing,
exposure = "rally",
outcome = 'hate_crime',
labels = c('rally' = "(X) Trump\nRally",
'hate_crime' = "(Y) Hate Crimes",
'changing' = 'Changing\nAttributes',
'unchanging' = 'Unchanging\nAttributes'
)) %>%
tidy_dagitty(layout='circle') %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
#geom_dag_node() +
geom_dag_edges_link(mapping = aes(label = c(1:6)),
angle_calc = "along", label_dodge = unit(c(1,-1,1,-1,-1),'lines'),
edge_linetype = rep(c(1,1,1,2,2), each = 100),
arrow = grid::arrow(length=grid::unit(c(10,10,10,0,0,0), 'pt'), type = 'closed')) +
geom_dag_text(mapping = aes(label = label), colour = 'black') +
theme_dag() +
scale_adjusted()
dagify(hate_crime ~ rally + unchanging + changing,
rally ~ unchanging + changing,
exposure = "rally",
outcome = 'hate_crime',
labels = c('rally' = "(X) Trump\nRally",
'hate_crime' = "(Y) Hate Crimes",
'changing' = 'Changing\nAttributes',
'unchanging' = 'Unchanging\nAttributes'
)) %>%
tidy_dagitty(layout='circle') %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
#geom_dag_node() +
geom_dag_edges_link(mapping = aes(label = c("","","","held constant\n(link broken)", "held constant\n(link broken)")),
angle_calc = "along", label_dodge = unit(c(1,-1,1,-1,-1),'lines'),
edge_linetype = rep(c(1,1,1,2,2), each = 100),
arrow = grid::arrow(length=grid::unit(c(10,10,10,0,0,0), 'pt'), type = 'closed')) +
geom_dag_text(mapping = aes(label = label), colour = 'black') +
theme_dag() +
scale_adjusted()
dagify(hate_crime ~ rally + unchanging + changing,
rally ~ unchanging + changing,
exposure = "rally",
outcome = 'hate_crime',
labels = c('rally' = "(X) Trump\nRally",
'hate_crime' = "(Y) Hate Crimes",
'changing' = 'Changing\nAttributes',
'unchanging' = 'Unchanging\nAttributes'
)) %>%
tidy_dagitty(layout='circle') %>%
ggplot(aes(x = x, y = y, xend = xend, yend = yend)) +
#geom_dag_node() +
geom_dag_edges_link(mapping = aes(label = c("","","","held constant\n(link broken)", "held constant\n(link broken)", "")),
angle_calc = "along", label_dodge = unit(c(1,-1,1,-1,-1),'lines'),
edge_linetype = rep(c(1,1,1,2,2), each = 100),
arrow = grid::arrow(length=grid::unit(c(10,10,10,0,0,0), 'pt'), type = 'closed')) +
geom_dag_text(mapping = aes(label = label), colour = 'black') +
theme_dag() +
scale_adjusted()
felm(hc_per_capita ~ I(l_rally > 0) | fips + sm_fe | 0 | fips  , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips  , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips  , rally_data) %>% summary
ggplot(trump_rally[t_window %in% c(-4,4)], aes(x = as.factor(t_window), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 5.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 196 Counties:\nBefore and After Trump Rallies")+
coord_cartesian(ylim = c(0,0.1))
ggplot(trump_rally[t_window %in% c(-4:4)], aes(x = as.factor(t_window), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 5.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 196 Counties:\nBefore and After Trump Rallies")+
coord_cartesian(ylim = c(0,0.1))
ggplot(trump_rally[t_window %in% c(-4:4)], aes(x = as.factor(t_window), y = hc_per_capita_alt)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 5.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 196 Counties:\nBefore and After Trump Rallies")+
coord_cartesian(ylim = c(0,0.1))
ggplot(trump_rally[t_window %in% c(-4:4)], aes(x = as.factor(t_window), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 5.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 196 Counties:\nBefore and After Trump Rallies")+
coord_cartesian(ylim = c(0,0.1))
ggplot(clinton_rally[t_window %in% c(-4:4)], aes(x = as.factor(t_window), y = hc_per_capita)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 5.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 40 Counties:\nBefore and After Clinton Rallies")+
coord_cartesian(ylim = c(0,0.1))
felm(hc_per_capita ~ I(l_rally > 0) | fips + monthyear | 0 | fips  , rally_data) %>% summary
felm(hc_per_capita ~ I(l2_rally > 0) | fips + monthyear | 0 | fips  , rally_data) %>% summary
felm(hc_per_capita ~ I(l_rally > 0) + I(l2_rally > 0) | fips + monthyear | 0 | fips  , rally_data) %>% summary
clinton_rally[, t_window] %>% table
clinton_rally[t_window %in% -4:4, list(t_window, hc_per_capita)] %>% plot
trump_rally[t_window %in% -4:4, list(t_window, hc_per_capita)] %>% plot
ggplot(trump_rally[t_window %in% c(-4:4)], aes(x = as.factor(t_window), y = hc_per_capita> 0)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black") +
geom_vline(xintercept = 5.5, colour = 'red', linetype = 'dashed') +
theme_bw() +
xlab("Time Since Rally") +
ylab("Hate Crimes per 100k") +
ggtitle("Hate Crimes in 196 Counties:\nBefore and After Trump Rallies")+
coord_cartesian(ylim = c(0,0.1))
ggplot(trump_rally[t_window %in% c(-4:4)], aes(x = as.factor(t_window), y = hc_per_capita>0)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black")
ggplot(trump_rally[t_window %in% c(-4:4)], aes(x = as.factor(t_window), y = (hc_per_capita>0)*1)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black")
felm(I(hc_per_capita> 0) ~ I(l_rally > 0) | fips + monthyear | 0 | fips  , rally_data) %>% summary
felm(I(hc_per_capita> 0) ~ I(l_rally > 0) | fips + sm_fe | 0 | fips  , rally_data) %>% summary
felm(I(hate_crimes > 0) ~ I(l_rally > 0) | fips + sm_fe | 0 | fips  , rally_data) %>% summary
felm(I(hate_crimes > 0) ~ I(l_rally > 0) | fips + monthyear | 0 | fips  , rally_data) %>% summary
rally_data[, list(hate_crimes, incidentcount)] %>% plot
felm(I(hate_crimes ) ~ I(l_rally > 0) | fips + monthyear | 0 | fips  , rally_data) %>% summary
felm(I(hate_crimes > 0) ~ I(l_rally > 0) | fips + monthyear | 0 | fips  , rally_data) %>% summary
rally_data[, hate_crimes] %>% hist
rally_data[, no_hc := all(hate_crimes == 0) , by= fips]
felm(I(hate_crimes > 0) ~ I(l_rally > 0) | fips + monthyear | 0 | fips  , rally_data[!(no_hc)]) %>% summary
felm(I(hc_per_capita > 0) ~ I(l_rally > 0) | fips + monthyear | 0 | fips  , rally_data[!(no_hc)]) %>% summary
ggplot(trump_rally[t_window %in% c(-4:4)], aes(x = as.factor(t_window), y = (hate_crimes>0)*1)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black")
ggplot(trump_rally[t_window %in% c(-4:4)], aes(x = as.factor(t_window), y = (incidentcount>0)*1)) +
stat_summary(fun.data=mean_cl_normal, fun.args = list(mult=1),
geom="errorbar", color="black", width=0.2) +
stat_summary(fun=mean, geom="point", color="black")
