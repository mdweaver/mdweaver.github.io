setwd('/home/mdweaver/Dropbox/POLI572b/lectures/lecture_11')
require(data.table)
require(knitr)
require(magrittr)
require(kableExtra)
require(ggplot2)
require(grid)
require(data.table)
require(UsingR)
require(lfe)
options("kableExtra.html.bsTable" = T)
require(data.table)
test = fread('./referenda_vote.csv')
test
?dcast
?melt
melt(vet, id.vars = c('state', "county", "enlist_pct"), measure = patterns("^suff"))
vet = fread('./referenda_vote.csv')
vet[, enlist_pct := veterans/mil_age]
melt(vet, id.vars = c('state', "county", "enlist_pct"), measure = patterns("^suff"))
vet_long[, post_war := str_detect(variable, "65")]
vet = fread('./referenda_vote.csv')
vet[, enlist_pct := veterans/mil_age]
vet_long = melt(vet, id.vars = c('state', "county", "enlist_pct"), measure = patterns("^suff"))
vet_long[, post_war := str_detect(variable, "65")]
require(data.table)
require(stringr)
vet = fread('./referenda_vote.csv')
vet[, enlist_pct := veterans/mil_age]
vet_long = melt(vet, id.vars = c('state', "county", "enlist_pct"), measure = patterns("^suff"))
vet_long[, post_war := str_detect(variable, "65")]
vet[, suff_diff := suff65_yes - suff57_yes]
require(data.table)
require(stringr)
vet = fread('./referenda_vote.csv')
vet[, enlist_pct := veterans/mil_age]
vet[, suff_diff := suff65_yes - suff57_yes]
vet[, county_u := paste(state, county, sep = ":")]
vet_long = melt(vet, id.vars = c('state', "county", "county_u", "enlist_pct"), measure = patterns("^suff"))
vet_long[, post_war := str_detect(variable, "65")]
require(data.table)
require(stringr)
vet = fread('./referenda_vote.csv')
vet[, enlist_pct := veterans/mil_age]
vet[, suff_diff := suff65_yes - suff57_yes]
vet[, county_u := paste(state, county, sep = ":")]
vet_long = melt(vet, id.vars = c('state', "county", "county_u", "enlist_pct"), measure = patterns("^suff"),value.name = 'suff_vote')
vet_long[, post_war := str_detect(variable, "65")]
dd_long = lm(suff_vote ~ enlist_pct*post_war + county_u, data = vet_long)
summary(dd_long)
dd_long = lm(suff_vote ~ enlist_pct*post_war + county_u + state, data = vet_long)
dd_long
dd_long = lm(suff_vote ~ enlist_pct*post_war + county_u + state:post_war, data = vet_long)
dd_long
vet = fread[('./referenda_vote.csv')][state %in% "IOWA"]
vet = fread[('./referenda_vote.csv')][state %in% "IOWA"]
vet[, enlist_pct := veterans/mil_age]
vet[, suff_diff := suff65_yes - suff57_yes]
vet = fread('./referenda_vote.csv')[state %in% "IOWA"]
vet
vet[, enlist_pct := veterans/mil_age]
vet[, suff_diff := suff65_yes - suff57_yes]
vet_long = melt(vet, id.vars = c('state', "county", "enlist_pct"), measure = patterns("^suff"),value.name = 'suff_vote')
vet_long[, post_war := str_detect(variable, "65")]
lm(suff_vote ~ enlist_pct*post_war + county, vet_long)
vet = vet[enlist_bct %between% c(0.1, 0.9)]
vet = fread('./referenda_vote.csv')[state %in% "IOWA"]
vet[, enlist_pct := veterans/mil_age]
vet[, suff_diff := suff65_yes - suff57_yes]
vet = vet[enlist_pct %between% c(0.1, 0.9)]
vet_long = melt(vet, id.vars = c('state', "county", "enlist_pct"), measure = patterns("^suff"),value.name = 'suff_vote')
vet_long[, post_war := str_detect(variable, "65")]
lm(suff_vote ~ enlist_pct*post_war + county, vet_long)
lm(suff_vote ~ enlist_pct*post_war , vet_long)
lm(suff_vote ~ enlist_pct*post_war , vet_long) %>% summay
lm(suff_vote ~ enlist_pct*post_war , vet_long) %>% summary
lm(suff_vote ~ enlist_pct*post_war + county , vet_long)
lm(suff_diff ~ enlist_pct, vet) %>% summary
lm(suff_vote ~ enlist_pct*post_war + county, vet_long)
lm(suff_vote ~ enlist_pct*post_war + county, vet_long) %>% summary
n = 5000
x = rnorm(n)
y = 3 + 0.5*x + 1*(x>0) + rnorm(n)
plot(x, y)
n = 5000
x = runif(n)
y = 3 + 0.5*x + 1*(x>0) + rnorm(n)
plot(x, y)
v
n = 5000
x = runif(n, -1,1)
y = 3 + 0.5*x + 1*(x>0) + rnorm(n)
plot(x, y)
n = 5000
x = runif(n, -1,1)
y = 3 + 1*x + 2*(x>0) + rnorm(n)
plot(x, y)
abline(v = 0)
abline(lm(y[x<0] ~ x[x<0]))
abline(lm(y[x>0] ~ x[x>0]))
?abline
d = data.frame(x,y)
d = data.frame(x,y, d = x>0)
ggplot(d, aes(x = x, y = y, group = d)) +
geom_line() +
geom_smooth()
ggplot(d, aes(x = x, y = y, group = d)) +
geom_point() +
geom_smooth()
